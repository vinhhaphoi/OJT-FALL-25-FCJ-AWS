<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content="VinhDQSE180012 | OJT_FALL_25 - AWS_FCJ_Internship Program"><meta name=author content="its.vnhdq@gmail.com"><link rel=icon href=../../images/favicon.png type=image/png><title>Blog 1 | Internship Report</title>
<link href=../../css/nucleus.css?1765505219 rel=stylesheet><link href=../../css/fontawesome-all.min.css?1765505219 rel=stylesheet><link href=../../css/hybrid.css?1765505219 rel=stylesheet><link href=../../css/featherlight.min.css?1765505219 rel=stylesheet><link href=../../css/perfect-scrollbar.min.css?1765505219 rel=stylesheet><link href=../../css/auto-complete.css?1765505219 rel=stylesheet><link href=../../css/atom-one-dark-reasonable.css?1765505219 rel=stylesheet><link href=../../css/theme.css?1765505219 rel=stylesheet><link href=../../css/hugo-theme.css?1765505219 rel=stylesheet><link href=../../css/theme-workshop.css?1765505219 rel=stylesheet><script src=../../js/jquery-3.3.1.min.js?1765505219></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=../../3-blogstranslated/3.1-blog1/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=../../><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../../js/lunr.min.js?1765505219></script><script type=text/javascript src=../../js/auto-complete.js?1765505219></script><script type=text/javascript>var baseurl="https://report.vinhhaphoi.com/"</script><script type=text/javascript src=../../js/search.js?1765505219></script></div><div class=highlightable><ul class=topics><li data-nav-id=/1-worklog/ title=Worklog class=dd-item><a href=../../1-worklog/><b>1. </b>Worklog
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/1-worklog/1.1-week1/ title="Week 1 Worklog" class=dd-item><a href=../../1-worklog/1.1-week1/><b>1.1. </b>Week 1 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.2-week2/ title="Week 2 Worklog" class=dd-item><a href=../../1-worklog/1.2-week2/><b>1.2. </b>Week 2 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.3-week3/ title="Week 3 Worklog" class=dd-item><a href=../../1-worklog/1.3-week3/><b>1.3. </b>Week 3 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.4-week4/ title="Week 4 Worklog" class=dd-item><a href=../../1-worklog/1.4-week4/><b>1.4. </b>Week 4 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.5-week5/ title="Week 5 Worklog" class=dd-item><a href=../../1-worklog/1.5-week5/><b>1.5. </b>Week 5 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.6-week6/ title="Week 6 Worklog" class=dd-item><a href=../../1-worklog/1.6-week6/><b>1.6. </b>Week 6 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.7-week7/ title="Week 7 Worklog" class=dd-item><a href=../../1-worklog/1.7-week7/><b>1.7. </b>Week 7 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.8-week8/ title="Week 8 Worklog" class=dd-item><a href=../../1-worklog/1.8-week8/><b>1.8. </b>Week 8 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.9-week9/ title="Week 9 Worklog" class=dd-item><a href=../../1-worklog/1.9-week9/><b>1.9. </b>Week 9 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.10-week10/ title="Week 10 Worklog" class=dd-item><a href=../../1-worklog/1.10-week10/><b>1.10. </b>Week 10 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.11-week11/ title="Week 11 Worklog" class=dd-item><a href=../../1-worklog/1.11-week11/><b>1.11. </b>Week 11 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.12-week12/ title="Week 12 Worklog" class=dd-item><a href=../../1-worklog/1.12-week12/><b>1.12. </b>Week 12 Worklog
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/2-proposal/ title=Proposal class=dd-item><a href=../../2-proposal/><b>2. </b>Proposal
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/ title="Translated Blogs" class="dd-item
parent"><a href=../../3-blogstranslated/><b>3. </b>Translated Blogs
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/3-blogstranslated/3.1-blog1/ title="Blog 1" class="dd-item
active"><a href=../../3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.2-blog2/ title="Blog 2" class=dd-item><a href=../../3-blogstranslated/3.2-blog2/><b>3.2. </b>Blog 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.3-blog3/ title="Blog 3" class=dd-item><a href=../../3-blogstranslated/3.3-blog3/><b>3.3. </b>Blog 3
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/4-eventparticipated/ title="Events Participated" class=dd-item><a href=../../4-eventparticipated/><b>4. </b>Events Participated
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/4-eventparticipated/4.1-event1/ title="Event 1" class=dd-item><a href=../../4-eventparticipated/4.1-event1/><b>4.1. </b>Event 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.2-event2/ title="Event 2" class=dd-item><a href=../../4-eventparticipated/4.2-event2/><b>4.2. </b>Event 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.3-event3/ title="Event 3" class=dd-item><a href=../../4-eventparticipated/4.3-event3/><b>4.3. </b>Event 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.4-event4/ title="Event 4" class=dd-item><a href=../../4-eventparticipated/4.4-event4/><b>4.4. </b>Event 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.5-event5/ title="Event 5" class=dd-item><a href=../../4-eventparticipated/4.5-event5/><b>4.5. </b>Event 5
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/ title=Workshop class=dd-item><a href=../../5-workshop/><b>5. </b>Workshop
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.1-introduction/ title=Introduction class=dd-item><a href=../../5-workshop/5.1-introduction/><b>5.1. </b>Introduction
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.2-prerequisites/ title="Prerequisites & Data" class=dd-item><a href=../../5-workshop/5.2-prerequisites/><b>5.2. </b>Prerequisites & Data
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.3-connect-data/ title="Connect Data" class=dd-item><a href=../../5-workshop/5.3-connect-data/><b>5.3. </b>Connect Data
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-create-visuals/ title="Create Visuals" class=dd-item><a href=../../5-workshop/5.4-create-visuals/><b>5.4. </b>Create Visuals
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.5-publish-dashboard/ title="Publish Dashboard" class=dd-item><a href=../../5-workshop/5.5-publish-dashboard/><b>5.5. </b>Publish Dashboard
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.6-cleanup/ title="Clean up" class=dd-item><a href=../../5-workshop/5.6-cleanup/><b>5.6. </b>Clean up
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/6-self-evaluation/ title=Self-Assessment class=dd-item><a href=../../6-self-evaluation/><b>6. </b>Self-Assessment
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/7-feedback/ title="Sharing and Feedback" class=dd-item><a href=../../7-feedback/><b>7. </b>Sharing and Feedback
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/vinhhaphoi2/><i class='fab fa-facebook'></i> Vinhhaphoi's Facebook Page</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://report.vinhhaphoi.com/3-blogstranslated/3.1-blog1/ selected>English</option><option id=vi value=https://report.vinhhaphoi.com/vi/3-blogstranslated/3.1-blog1/>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/vinhhaphoi/OJT-FALL-25-FCJ-AWS3-BlogsTranslated/3.1-Blog1/_index.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=../../>Internship Report</a> > <a href=../../3-blogstranslated/>Translated Blogs</a> > Blog 1</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><a href=#introduction-to-nested-materialized-views>Introduction to Nested Materialized Views</a></li><li><a href=#architecture>Architecture</a></li><li><a href=#creating-and-using-nested-materialized-views>Creating and using nested materialized views</a></li><li><a href=#best-practices-for-materialized-view>Best Practices for Materialized View</a></li><li><a href=#clean-up>Clean up</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#about-the-authors>About the authors</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Blog 1</h1><h1 id=harnessing-the-power-of-nested-materialized-views-and-exploring-cascading-refresh>Harnessing the Power of Nested Materialized Views and exploring Cascading Refresh</h1><h3 id=introduction-to-nested-materialized-views>Introduction to Nested Materialized Views</h3><p>Nested materialized views in Amazon Redshift allow you to create materialized views based on other materialized views. This capability enables a hierarchical structure of precomputed results, significantly enhancing query performance and data processing efficiency. With nested materialized views, you can build multi-layered data abstractions, creating increasingly complex and specialized views tailored to specific business needs. This layered approach offers several advantages:</p><ul><li><strong>Improved Query Performance</strong>: Each level of the nested materialized view hierarchy serves as a cache, allowing queries to quickly access pre-computed data without the need to traverse the underlying base tables.</li><li><strong>Reduced Computational Load</strong>: By offloading the computational work to the materialized view refresh process, you can significantly reduce the runtime and resource utilization of your day-to-day queries.</li><li><strong>Simplified Data Modeling</strong>: Nested materialized views enable you to create a more modular and extensible data model, where each layer represents a specific business concept or use case.</li><li><strong>Incremental Refreshes</strong>: The Redshift materialized views support incremental refreshes, allowing you to update only the changed data within the nested hierarchy, further optimizing the refresh process.</li><li><strong>Cascading Materialized Views</strong>: The Redshift materialized views with CASCADE can help business users to eliminate the need of creating and maintaining their own data pipelines.</li></ul><p>You can implement nested materialized views using the <a href=https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-create-sql-command.html>CREATE MATERIALIZED VIEW</a> statement, which allows referencing other materialized views in the definition. Common use cases include:</p><ul><li>Modular data transformation pipelines</li><li>Hierarchical aggregations for progressive analysis</li><li>Multi-level data validation pipelines</li><li>Historical data snapshot management</li><li>Optimized BI reporting with precomputed results</li></ul><h3 id=architecture>Architecture</h3><p>Architectural diagram depicting Amazon Redshift’s nested materialized view structure. Shows multiple base tables (orange) connecting to materialized views (red), with connections to a nested view layer and data sharing table (green). Includes integration points for users and QuickSight visualization.</p><ol><li><strong>Base Table(s)</strong>: These are the underlying base tables that contain the raw data for your data warehouse. It can be local tables or data sharing tables.</li><li><strong>Base Materialized View(s)</strong>: These are the first-level materialized views that are created directly on top of the base tables. These views encapsulate common data transformations and aggregations. This can serve as the base for the nested materialized view and also be accessed by users directly.</li><li><strong>Nested Materialized View(s)</strong>: These are the second level (or higher) materialized views that are created based on the base materialized views. The nested materialized view can further aggregate, filter, or transform the data from the base materialized views.</li><li><strong>Application/Users/BI Reporting</strong>: The application or business intelligence (BI) tools interact with the nested materialized views to generate reports and dashboards. The nested views provide a more optimized and precomputed data structure for efficient querying and reporting.</li></ol><h3 id=creating-and-using-nested-materialized-views>Creating and using nested materialized views</h3><p>To demonstrate how nested materialized views work in Amazon Redshift, we’ll use the TPC-DS dataset. We’ll create three queries using the STORE, STORE_SALES, CUSTOMER, and CUSTOMER_ADDRESS tables to simulate data warehouse reports. This example will illustrate how multiple reports can share result sets and how materialized views can improve both resource efficiency and query performance.</p><p>Let’s consider the following queries as dashboard queries:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> cust.c_customer_id, cust.c_first_name, cust.c_last_name, sales.ss_item_sk, sales.ss_quantity, cust.c_current_addr_sk
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> store_sales sales
</span></span><span style=display:flex><span><span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> customer cust <span style=color:#66d9ef>ON</span> sales.ss_customer_sk <span style=color:#f92672>=</span> cust.c_customer_sk;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> cust.c_customer_id, cust.c_first_name, cust.c_last_name, sales.ss_item_sk, sales.ss_quantity, cust.c_current_addr_sk, store.s_store_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> store_sales sales
</span></span><span style=display:flex><span><span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> customer cust <span style=color:#66d9ef>ON</span> sales.ss_customer_sk <span style=color:#f92672>=</span> cust.c_customer_sk
</span></span><span style=display:flex><span><span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> store store <span style=color:#66d9ef>ON</span> sales.ss_store_sk <span style=color:#f92672>=</span> store.s_store_sk;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> cust.c_customer_id, cust.c_first_name, cust.c_last_name, sales.ss_item_sk, sales.ss_quantity, addr.ca_state
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> store_sales sales
</span></span><span style=display:flex><span><span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> customer cust <span style=color:#66d9ef>ON</span> sales.ss_customer_sk <span style=color:#f92672>=</span> cust.c_customer_sk
</span></span><span style=display:flex><span><span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> store store <span style=color:#66d9ef>ON</span> sales.ss_store_sk <span style=color:#f92672>=</span> store.s_store_sk
</span></span><span style=display:flex><span><span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> customer_address addr <span style=color:#66d9ef>ON</span> cust.c_current_addr_sk <span style=color:#f92672>=</span> addr.ca_address_sk;
</span></span></code></pre></div><p>Notice that the join between STORE_SALES and CUSTOMER tables is present at all 3 queries (dashboards).
The second query adds a join with STORE table and the third query is the second one with an extra join with CUSTOMER_ADDRESS table. This pattern is common in business intelligence scenarios. As mentioned earlier, using a materialized view can speed up queries because the result set is stored and ready to be delivered to the user, avoiding reprocessing of the same data. In cases like this, we can use nested materialized views to reuse already processed data.</p><p>When transforming our queries into a set of nested materialized views, the result would be as below:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> MATERIALIZED <span style=color:#66d9ef>VIEW</span> StoreSalesCust <span style=color:#66d9ef>as</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> cust.c_customer_id, cust.c_first_name, cust.c_last_name, sales.ss_item_sk, sales.ss_store_sk, sales.ss_quantity, cust.c_current_addr_sk
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> store_sales sales
</span></span><span style=display:flex><span><span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> customer cust <span style=color:#66d9ef>ON</span> sales.ss_customer_sk <span style=color:#f92672>=</span> cust.c_customer_sk;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> MATERIALIZED <span style=color:#66d9ef>VIEW</span> StoreSalesCustStore <span style=color:#66d9ef>as</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> storesalescust.c_customer_id, storesalescust.c_first_name, storesalescust.c_last_name, storesalescust.ss_item_sk, storesalescust.ss_quantity, storesalescust.c_current_addr_sk, store.s_store_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> StoreSalesCust storesalescust
</span></span><span style=display:flex><span><span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> store store <span style=color:#66d9ef>ON</span> storesalescust.ss_store_sk <span style=color:#f92672>=</span> store.s_store_sk;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> MATERIALIZED <span style=color:#66d9ef>VIEW</span> StoreSalesCustAddress <span style=color:#66d9ef>as</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> storesalescuststore.c_customer_id, storesalescuststore.c_first_name, storesalescuststore.c_last_name, storesalescuststore.ss_item_sk, storesalescuststore.ss_quantity, addr.ca_state
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> StoreSalesCustStore storesalescuststore
</span></span><span style=display:flex><span><span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> customer_address addr <span style=color:#66d9ef>ON</span> storesalescuststore.c_current_addr_sk <span style=color:#f92672>=</span> addr.ca_address_sk;
</span></span></code></pre></div><p>Nested materialized views can improve performance and resource efficiency by reusing initial view results, minimizing redundant joins, and working with smaller result sets. This creates a hierarchical structure where materialized views depend on one another. Due to these dependencies, you must refresh the views in a specific order.</p><p>With the new option “REFRESH MATERIALIZED VIEW mv_name CASCADE” you will be able to refresh the entire chain of dependencies for the materialized views you have. Note that in this example we are using the third materialized view, StoreSalesCustAddress, and this will refresh all 3 materialized views because they are dependent on each other.</p><p>If we use the second materialized view with the CASCADE option, we will refresh only the first and second materialized views, leaving the third unchanged. This may be useful when we need to keep some materialized views with less current data than others.</p><p>The <a href=https://docs.aws.amazon.com/redshift/latest/dg/r_SVL_MV_REFRESH_STATUS.html>SVL_MV_REFRESH_STATUS</a> system view reveals the refresh sequence of materialized views. When triggering a cascade refresh on StoreSalesCustAddress, the system follows the dependency chain we established: StoreSalesCust refreshes first, followed by StoreSalesCustStore, and finally StoreSalesCustAddress. This demonstrates how the refresh operation respects the hierarchical structure of our materialized views.</p><h4 id=considerations>Considerations</h4><p>Consider a dependency chain where StoreSalesCust (A) → StoreSalesCustStore (B) → StoreSalesCustAddress (C).</p><ul><li>The CASCADE refresh behavior works as follows:<ul><li>When refreshing C with CASCADE: A, B, and C will all be refreshed.</li><li>When refreshing B with CASCADE: Only A and B will be refreshed.</li><li>When refreshing A with CASCADE: Only A will be refreshed.</li><li>If you specifically need to refresh A and C but not B, you must perform separate refresh operations without using CASCADE—first refresh A, then refresh C directly.</li></ul></li></ul><h3 id=best-practices-for-materialized-view>Best Practices for Materialized View</h3><ul><li><strong>Improve the source query</strong>: Start with a well-optimized SELECT statement for your materialized view. This is especially important for views that need full rebuilds during each refresh.</li><li><strong>Plan refresh strategies</strong>: When creating materialized views that depend on other materialized views, you cannot use AUTO REFRESH YES. Instead, implement orchestrated refresh mechanisms using Redshift Data API with Amazon EventBridge for scheduling and AWS Step Functions for workflow management.</li><li><strong>Leverage distribution and sort keys</strong>: Properly configure distribution and sort keys on materialized views based on their query patterns to optimize performance. Well-chosen keys improve query speed and reduce I/O operations.</li></ul><h3 id=clean-up>Clean up</h3><p>Complete the following steps to clean up your resources:</p><ul><li>Delete the Redshift provisioned replica cluster or the Redshift serverless endpoints created for this exercise
or</li><li>Drop only the Materialized view which you have created for testing</li></ul><h3 id=conclusion>Conclusion</h3><p>This post showed how to create nested Amazon Redshift materialized views and refresh the child materialized views using the new REFRESH CASCADE option. You can quickly build and maintain efficient data processing pipelines and seamlessly extend the low latency query execution benefits of materialized views to data analysis.</p><p>If you’re unfamiliar with materialized views but want to boost your workload performance, Amazon Redshift offers an Automated materialized view (auto-MV) feature. This intelligent system monitors your workload and automatically creates materialized views to enhance overall performance. For more detailed information on this feature, please refer to <a href=https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-auto-mv.html>Automated materialized views</a>.</p><h3 id=about-the-authors>About the authors</h3><p><strong>Ritesh Kumar Sinha</strong> is an Analytics Specialist Solutions Architect based out of San Francisco. He has helped customers build scalable data warehousing and big data solutions for over 16 years. He loves to design and build efficient end-to-end solutions on AWS. In his spare time, he loves reading, walking, and doing yoga.</p><p><strong>Raza Hafeez</strong> is a Senior Product Manager at Amazon Redshift. He has over 13 years of professional experience building and optimizing enterprise data warehouses and is passionate about enabling customers to realize the power of their data. He specializes in migrating enterprise data warehouses to AWS Modern Data Architecture.</p><p><strong>Ricardo Serafim</strong> is a Senior Analytics Specialist Solutions Architect at AWS. He has been helping companies with Data Warehouse solutions since 2007.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=../../3-blogstranslated/ title="Translated Blogs"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../3-blogstranslated/3.2-blog2/ title="Blog 2" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../../js/clipboard.min.js?1765505219></script><script src=../../js/perfect-scrollbar.min.js?1765505219></script><script src=../../js/perfect-scrollbar.jquery.min.js?1765505219></script><script src=../../js/jquery.sticky.js?1765505219></script><script src=../../js/featherlight.min.js?1765505219></script><script src=../../js/highlight.pack.js?1765505219></script><script>hljs.initHighlightingOnLoad()</script><script src=../../js/modernizr.custom-3.6.0.js?1765505219></script><script src=../../js/learn.js?1765505219></script><script src=../../js/hugo-learn.js?1765505219></script><link href=../../mermaid/mermaid.css?1765505219 rel=stylesheet><script src=../../mermaid/mermaid.js?1765505219></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>